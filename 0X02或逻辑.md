# 0X02 或逻辑

## 词项

"词项"这个词也是我造的,用于表示英文中的"term".在 EBNF 中字符串字面值和定义过的名词都是词项.

每一条定义语句都有三个部分组成--左边的被定义名词,中间的定义符号(一般是等号),左边的定义表达式.

定义表达式由若干词项和链接词项的运算符组成.

我个人建议把 BNF 中的规则定义理解为字符串运算.就如我们之前所说,两个词项用逗号连接就表示两个词项的内容首尾相接,返回连接后的内容.这里可以把逗号的作用等同于 Lua 中的'..'双句点.

## 或运算

字符串没有且运算(你硬要把字符串连接看成且运算也可以),但是由或运算.或表示两个字符串任选其一.例如:

```EBNF
seq1 = '123' | 'abc';
```

这里的 seq1 既可以是'123',也可以是'abc'.但是不能是别的值(比如把'123'和'abc'连起来).其中的'|'表示或关系.

## 运算优先级

有运算就有运算的优先级.和其他语言中的表达式类似,EBNF使用圆括号表示运算的优先级.(如果不加圆括号,默认连接(逗号)比或运算(竖线)优先.)

```EBNF
seq2 = 'a', ('1' | '2'), 'b';
```

这个规则表示 seq2,开头必须是'a',结尾必须是'b',但是中间的部分可以是'1'也可以是'2'.所以实际上符合这个规则的字符串只有两种情况'a1b'或者'a2b'.

按照 ISO 的标准定义,圆括号其实是不可以嵌套使用的(它的内部只允许词项,'|'和','这三种东西出现).这样的定义可能是为了保持定义语句的可读性.

## BNF 风格

其实有了或运算,我们不需要圆括号,方括号这些语法也可以完整地定义编程语言了.

例如圆括号可以通过分两步定义(用一个名词作为中介)来完成.这里的 seq4 等价于上边的 seq2:

```EBNF
seq3 = '1' | '2';
seq4 = 'a', seq3, 'b';
```

如果要表达一个部分是可选的可以用这种方式:

```EBNF
seq5 = 'a';
seq6 = 'a', seq4;
seq7 = seq5 | seq6;
```

对于 seq7 来说, seq4 的内容就是可选的.可以在末尾有 seq4 的内容,也可以没有.

由于 EBNF 允许递归定义(在一个名字的定义中使用它自己),我们也可以这样表示可以重复若干次的内容:

```EBNF
seq8 = 'a' | 'a', seq8;
```

这里的 seq8 可以是'a'或者'a'后接一个 seq8.

由于'a'是 seq8,所以'aa'也是 seq8.

由于'aa'是 seq8,所以'aaa'也是 seq8.这个过程可以无限进行下去. seq8 表示的是由字符'a'组成的,长度大于等于1的所有字符串.

最初的 BNF 中其实并没有圆括号,方括号,花括号这些语法. EBNF 引入它们仅仅是为了让 BNF 写起来更简洁,可读性更强.
